# one-hot

## one-hot 编码
one-hot编码，又称独热编码、一位有效编码。其方法是使用N位状态寄存器来对N个状态进行编码，每个状态都有它独立的寄存器位，并且在任意时候，其中只有一位有效。

举例：

||性别|区域|年龄段|
|---|---|---|---|
|张三|男|D区|老年|
|李四|女|C区|中年|
|王五|男|B区|中年|
|赵六|女|A区|青年|

上表中我们看到，性别有2种取值。区域有4中取值，年龄段有3中取值。对于这种离散型数据，我们可以简单的用数字编码，比如下表：

|特征|男|女|A区|B区|C区|D区|青年|中年|老年|
|-|-|-|-|-|-|-|-|-|-|
|编码|1|2|1|2|3|4|1|2|3|

则我们的数据可编码为以下格式：

||性别|区域|年龄段|
|---|---|---|---|
|张三|1|4|3|
|李四|2|3|2|
|王五|1|2|2|
|赵六|2|1|1|

但是这样编码的话，在模型训练中很可能出现问题，比如区域是无大小之分的，但我们现在的编码却引入了大小顺序等原本没有的特征，模型学习的权重也会因此受到影响，尽管实际上A区和D区是等价的关系，没有谁大谁小，谁先谁后之分。

one-hot编码就不存在这样的问题，他能做到真正的平等对待。那么one-hot具体是如何编码呢？

比如区域有4种取值，那么就用4个状态位表示。对于一个样本来说，只在样本对应的状态位置1，其余状态位为0。所以区域可以编码如下：

|性别|编码|
|---|---|
|A区|1000|
|B区|0100|
|C区|0010|
|D区|0001|

性别，年龄段也用one-hot编码的话，则数据最终可以如下表：

||性别|区域|年龄段|
|---|---|---|---|
|张三|10|0001|001|
|李四|01|0010|010|
|王五|10|0100|010|
|赵六|01|1000|100|

其实年龄段是有大小之分的，是否应该用one-hot编码还要看具体情况，我们这里只是为了讲解one-hot编码的知识，就把各个年龄段也看做相互独立的特征了。

最终我们4个样本可以编码为下面的特征向量：

||特征向量|
|-|-|
|张三|100001001|
|李四|010010010|
|王五|100100010|
|赵六|011000100|

## one-hot在提取文本特征上的应用

one hot在特征提取上属于词袋模型（bag of words）。关于如何使用one-hot抽取文本特征向量我们通过以下例子来说明。假设我们的语料库中有三段话：
```
我爱中国
爸爸妈妈爱我
爸爸妈妈爱中国
```
我们首先对预料库分离并获取其中所有的词，然后对每个词进行编号：
|编号|1|2|3|4|5|
|-|-|-|-|-|-|
|词汇|我|爱|爸爸|妈妈|中国|

然后使用one hot对每段话提取特征向量：

“我爱中国”。 
包含我，爱，中国三个词，把这是三个词对应的状态位置1，其余为0。
|我|爱|爸爸|妈妈|中国|
|-|-|-|-|-|
|1|1|0|0|1|

“爸爸妈妈爱我”。包含爸爸，妈妈，爱，我4个词，把这是4个词对应的状态位置1，其余为0。
|我|爱|爸爸|妈妈|中国|
|-|-|-|-|-|
|1|1|1|1|0|

“爸爸妈妈爱中国”。包含爸爸，妈妈，爱，中国4个词，把这是4个词对应的状态位置1，其余为0。
|我|爱|爸爸|妈妈|中国|
|-|-|-|-|-|
|0|1|1|1|1|

可以参考[特征抽取](/documents/特征抽取.md)中的词袋法和词集法

## 使用sklearn进行one-hot编码

代码：
```python
from sklearn import preprocessing  
      
enc = preprocessing.OneHotEncoder()  # 创建对象
enc.fit([[0,0,3],[1,1,0],[0,2,1],[1,0,2]])   # 拟合
array = enc.transform([[0,1,3]]).toarray()  # 转化
print(array)
```
结果：
```
[[1. 0. 0. 1. 0. 0. 0. 0. 1.]]
```


---
**参考**：  
* [特征提取方法: one-hot 和 TF-IDF](https://www.cnblogs.com/lianyingteng/p/7755545.html)


